
SELECT T.OWNER,
T.TABLE_NAME,
T.NUM_ROWS,
T.LAST_ANALYZED,S.BLOCKS,
ROUND(T.NUM_ROWS * T.AVG_ROW_LEN /1024/1024/1024 , 2) OCUPADO_GB,T.AVG_ROW_LEN,
ROUND(S.BYTES / 1024 / 1024/1024, 2) ALOCADO_GB,PARTITIONED
FROM DBA_TABLES T, DBA_SEGMENTS S
WHERE T.OWNER = S.OWNER
AND S.SEGMENT_NAME = T.TABLE_NAME
AND S.SEGMENT_NAME IN ('USAGE_EVENT','DYNAMIC_BASKET');